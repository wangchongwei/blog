---
title: android 应用启动流程
date: 2021-03-09 13:47:56
tags: android
---

android 应用启动过程分为冷启动、热启动

我们从应用入口开始分析

## ActivityThread

android 应用的主入口，
在 main 函数中，会启动消息机制。

在 performLaunchActivity 函数中，会构建 Activity 对象，然后调用 activity 中的 attach 函数。

而在 attach 函数中，会构建 Activity 的 PhoneWindow 以及 decorView

在 ActivityThread 中的 handleResumeActivity 函数中，会将 decorView 添加到 windowManager 中

```java
  r.window = r.activity.getWindow();
  View decor = r.window.getDecorView();
  decor.setVisibility(View.INVISIBLE);
  ViewManager wm = a.getWindowManager();
  if (!a.mWindowAdded) {
    a.mWindowAdded = true;
    wm.addView(decor, l);
  }

```
